<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>AIチャット確認用（Falcon）</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
    #chat { background: white; padding: 20px; border-radius: 12px; max-width: 500px; margin: auto; }
    input, button { font-size: 16px; margin-top: 10px; width: 100%; padding: 10px; }
    #response { white-space: pre-wrap; background: #eee; padding: 10px; margin-top: 10px; border-radius: 8px; }
  </style>
</head>
<body>
  <div id="chat">
    <h2>Falconチャット（テスト用）</h2>
    <input type="text" id="prompt" placeholder="こんにちはAI">
    <button onclick="send()">送信</button>
    <div id="response">ここに返答が出るゾ</div>
  </div>

  <script>
    const HF_TOKEN = "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";  // ← トークンを正しく差し替える
    const MODEL_URL = "https://api-inference.huggingface.co/models/tiiuae/falcon-rw-1b";

    async function send() {
      const input = document.getElementById("prompt").value;
      const responseDiv = document.getElementById("response");
      responseDiv.textContent = "送信中…";

      try {
        const res = await fetch(MODEL_URL, {
          method: "POST",
          headers: {
            "Authorization": "Bearer " + HF_TOKEN,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ inputs: input })
        });

        const data = await res.json();
        if (data.error) {
          responseDiv.textContent = "エラー: " + data.error;
        } else if (Array.isArray(data) && data[0]?.generated_text) {
          responseDiv.textContent = data[0].generated_text;
        } else {
          responseDiv.textContent = JSON.stringify(data, null, 2);  // 念のため全体表示
        }
      } catch (e) {
        responseDiv.textContent = "ネットワークエラー: " + e.message;
      }
    }
  </script>
</body>
</html>
