<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç¿»è¨³</title>
<link rel="stylesheet" href="tr.css">
</head>
<body>
  <div class="fade-blue"></div>
  <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³è¿½åŠ  -->
  <div class="close-button" id="closeBtn" title="Close"></div>

  <div class="mic-wrapper" id="wrapper" onclick="swapDirection()">
    <div id="mic" class="mic"></div>
  </div>

  <div id="jp">
    <input id="inputText" type="text"
    placeholder="ã“ã“ã«å…¥åŠ›â€¦"
    autocomplete="off"
    autocorrect="off"
    autocapitalize="off"
    spellcheck="false"
    name="no_save" />  
  </div>

  <div id="en"></div>

  <script>
    // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã®å‡¦ç†
    document.getElementById('closeBtn').addEventListener('click', () => {
      // å…¨è¦ç´ ã‚’slide-down
      document.getElementById('wrapper').classList.add('slide-down');
      document.getElementById('jp').classList.add('slide-down');
      document.getElementById('en').classList.add('slide-down');
      document.getElementById('closeBtn').classList.add('slide-down');
      setTimeout(() => {
        location.href = 'en.html';
      }, 510); // ã‚¢ãƒ‹ãƒ¡å¾Œã«é·ç§»
    });

    // micã®æ‹¡å¤§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    window.addEventListener("DOMContentLoaded", () => {
      const mic = document.getElementById("mic");
      mic.style.transform = "scale(0.5)";
      mic.style.transition = "transform 0.7s cubic-bezier(.6,1.6,.2,1)";
      setTimeout(() => {
        mic.style.transform = "scale(1)";
      }, 80); // slight delay for effect
    });
</script>
  <script>
    const micEl = document.getElementById("mic");
    const wrapperEl = document.getElementById("wrapper");
    const jpEl = document.getElementById("jp");
    const enEl = document.getElementById("en");
    const inputEl = document.getElementById("inputText");
  
    let isJpToEn = true;
    let enterCount = 0;
  
    async function translate(text) {
  if (!text) return "";
  const from = isJpToEn ? "ja" : "en";
  const to = isJpToEn ? "en" : "ja";
  const res = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${from}|${to}&rand=${Date.now()}`);
  const data = await res.json();
  return data.responseData.translatedText || "";
}

    inputEl.addEventListener("input", async () => {
      enterCount = 0; // ğŸ” Enterã‚«ã‚¦ãƒ³ãƒˆãƒªã‚»ãƒƒãƒˆ
      const text = inputEl.value;
      const translated = await translate(text);
      enEl.textContent = translated;
  
      enEl.classList.remove("show");
      void enEl.offsetWidth;
      enEl.classList.add("show");
  
      micEl.classList.remove("pulse");
      void micEl.offsetWidth;
      micEl.classList.add("pulse");
    });
  
    function triggerSlideUp(el) {
      el.classList.remove("slide-up");
      void el.offsetWidth;
      el.classList.add("slide-up");
    }
  
    function swapDirection() {
      isJpToEn = !isJpToEn;
  
      if (isJpToEn) {
        jpEl.style.bottom = "30px";
        jpEl.style.top = "";
        enEl.style.top = "30px";
        enEl.style.bottom = "";
        enEl.style.transform = "rotate(180deg)";
        inputEl.placeholder = "ã“ã“ã«å…¥åŠ›â€¦";
      } else {
        jpEl.style.bottom = "";
        jpEl.style.top = "30px";
        enEl.style.top = "";
        enEl.style.bottom = "30px";
        enEl.style.transform = "rotate(0deg)";
        inputEl.placeholder = "Type here...";
      }
  
      resetAll();
      triggerSlideUp(jpEl);
    }
  
    // ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
    function resetAll() {
      inputEl.value = "";
      enEl.textContent = "";
      enEl.classList.remove("show");
      enterCount = 0;
      inputEl.focus();
    }
  
    // ğŸ§  Micã‚¯ãƒªãƒƒã‚¯ã§ãƒªã‚»ãƒƒãƒˆ
    wrapperEl.addEventListener("click", () => {
      resetAll();
      micEl.classList.remove("pulse");
      void micEl.offsetWidth;
      micEl.classList.add("pulse");
    });
  
    // ğŸ’£ Enter2å›ç›®ã§ãƒªã‚»ãƒƒãƒˆ
    inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        enterCount++;
  
        const input = inputEl.value.trim().toLowerCase();
  
        // è¨€èªåˆ‡ã‚Šæ›¿ãˆã‚³ãƒãƒ³ãƒ‰
        if (isJpToEn && (input === "english" || input === "change to english" || input === "us" || input === "eigo")) {
          swapDirection();
          return;
        }
        if (!isJpToEn && (input.includes("æ—¥æœ¬èª") || input.includes("æ—¥æœ¬") || input.includes("ã‹ãª") || input.includes("ã‚") || input.includes("ã«ã»ã‚“"))) {
          swapDirection();
          return;
        }
  
        // 2å›ç›®ã®Enterã§å…¨å‰Šé™¤
        if (enterCount >= 2) {
          resetAll();
        }
      }
    });
    window.addEventListener("load", () => {
  // ğŸš« è‡ªå‹•å¾©å…ƒå¯¾ç­–
  inputEl.value = "";
  enEl.textContent = "";
  enEl.classList.remove("show");
});


window.addEventListener('DOMContentLoaded', () => {
  setTimeout(() => {
    document.body.classList.add('faded');
  }, 420); // â†ã“ã“å¥½ããªç§’æ•°ã§
});


  </script>
  
</body>
</html>
